(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0d6afb44"],{"2d76":function(e,t,a){},"308f":function(e,t,a){"use strict";a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return o})),a.d(t,"b",(function(){return l}));var n=a("b775");function s(e){return Object(n["a"])({url:"/asset/list",method:"get",params:e})}function i(e){return Object(n["a"])({url:"/asset/delete/"+e,method:"post"})}var o="https://cms.skykj.com.cn/api/asset/upload",l="https://cms.skykj.com.cn/api/v1/asset/"},5545:function(e,t,a){},5987:function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"5a1e":function(e,t,a){"use strict";a("2d76")},ba6f:function(e,t,a){"use strict";a("5545")},bd50:function(e,t,a){"use strict";var n=a("48b9"),s=a("4152"),i=a("76db"),o=a("54e2"),l=a("60f0"),r=a("5987"),c=a("7462"),u=a("5c78"),d=a("562b");s("search",(function(e,t,a){return[function(t){var a=l(this),s=o(t)?void 0:u(t,e);return s?n(s,t,a):new RegExp(t)[e](c(a))},function(e){var n=i(this),s=c(e),o=a(t,n,s);if(o.done)return o.value;var l=n.lastIndex;r(l,0)||(n.lastIndex=0);var u=d(n,s);return r(n.lastIndex,l)||(n.lastIndex=l),null===u?-1:u.index}]}))},d4fd:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:e.title,visible:e.visible,width:e.width,"append-to-body":"","modal-append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.visible=t}}},[e._t("default"),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{loading:e.confirmLoading,icon:"el-icon-close"},on:{click:e.handleCancel}},[e._v(e._s(e.cancelText))]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.confirmText,expression:"confirmText"}],attrs:{type:"primary",icon:"el-icon-check",loading:e.confirmLoading},on:{click:e.handleConfirm}},[e._v(e._s(e.confirmText))]),e._t("operate")],2)],2)},s=[],i={props:{confirmText:{default:"",type:String},title:{default:"",type:String},width:{default:"600px",type:String},confirmLoading:{default:!1,type:Boolean},visible:{default:!1,type:Boolean},cancelText:{default:"取消",type:String}},methods:{handleCancel:function(){this.$emit("cancel")},handleConfirm:function(){this.$emit("confirm")}}},o=i,l=(a("5a1e"),a("e607")),r=Object(l["a"])(o,n,s,!1,null,null,null);t["a"]=r.exports},f3e7:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",[a("el-col",{staticClass:"search-container",attrs:{span:24}},[a("el-form",{ref:"_search",attrs:{model:e.search,inline:"",size:"small"}},[a("el-form-item",[a("el-input",{staticClass:"w220",attrs:{clearable:"",placeholder:"图片名"},model:{value:e.search.name,callback:function(t){e.$set(e.search,"name",t)},expression:"search.name"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.fetchData}},[e._v("筛选")])],1)],1)],1),a("el-col",{attrs:{span:24}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-upload",size:"mini"},on:{click:e.uploadResource}},[e._v("上传图片")])],1),a("el-col",{attrs:{span:24}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"margin-top":"15px"},attrs:{data:e.assets.list,"highlight-current-row":"",stripe:"",border:"",size:"mini"}},[a("el-table-column",{attrs:{prop:"f_code",label:"展示 ID",width:"260",align:"center"}}),a("el-table-column",{attrs:{prop:"name",label:"图片"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("img",{staticClass:"list-img",attrs:{src:e._f("lsImg")(t.row.f_code)}})]}}])}),a("el-table-column",{attrs:{prop:"name",label:"图片名"}}),a("el-table-column",{attrs:{align:"center",label:"操作",fixed:"right",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button-group",{staticClass:"table-operate"},[a("el-button",{attrs:{type:"danger",plain:""},nativeOn:{click:function(a){return a.preventDefault(),e.delRow(t.row.id)}}},[e._v("删除")])],1)]}}])})],1)],1),a("el-col",{staticStyle:{"margin-top":"15px"},attrs:{span:24}},[a("page",{ref:"page",attrs:{page:e.search.page,total:e.assets.total},on:{"current-change":e.handlePage,"size-change":e.handlePageSize}}),a("image-upload",{ref:"upload",on:{"upload-success":e.fetchData}})],1)],1)},s=[],i=(a("7869"),a("bd50"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("dialog-panel",{attrs:{title:"课程图上传",visible:e.visible,"confirm-text":"确认上传","cancel-text":"关闭","confirm-loading":e.loading,width:"700px"},on:{cancel:e.cancel,confirm:e.upload}},[a("el-form",{ref:"assetForm",attrs:{model:e.assetForm,"label-width":"110px",size:"mini"}},[a("el-form-item",{attrs:{label:"上传提示"}},[a("p",[e._v("1. 以图片文件命名")]),a("p",[e._v("2. 图片过大可在 "),a("a",{staticStyle:{color:"#1890ff"},attrs:{href:"https://tinypng.com/",target:"_blank"}},[e._v("此站")]),e._v(" 压缩")]),a("p",{staticClass:"text-error"},[e._v("3. 小程序主页课程列表图要求尺寸：500*300")]),a("p",[e._v("4. 其他图片尺寸按具体位置要求上传（配置列表）")])]),a("el-form-item",{attrs:{label:"选择图片素材",prop:"assets",rules:{required:!0}}},[a("el-upload",{ref:"assetUpload",attrs:{action:e.uploadUrl,headers:e.headers,multiple:"",limit:5,"on-exceed":e.overLimit,name:"file","auto-upload":!1,"file-list":e.fileList,data:e.assetForm,"on-change":e.handleChange,"on-remove":e.handleChange,accept:e.accepts,"on-error":e.uploadErr,"on-success":e.uploadSuccess}},[a("el-button",{attrs:{slot:"trigger",type:"primary",plain:"",icon:"el-icon-plus"},slot:"trigger"},[e._v("选取文件（单图 100 KB内，一次性最大上传 5 张）")])],1)],1)],1)],1)}),o=[],l=(a("522e"),a("82ab"),a("d4fd")),r=a("5f87"),c=a("308f"),u={components:{DialogPanel:l["a"]},data:function(){return{visible:!1,loading:!1,dimensionShow:!1,assetForm:{},accepts:".jpg,.jpeg,.png",headers:{Authorization:"Bearer "+Object(r["a"])()},fileList:[],assetNumbers:{total:0,success:0,failed:0}}},computed:{uploadUrl:function(){return c["d"]}},methods:{initUpload:function(){this.visible=!0},handleChange:function(e,t){this.assetNumbers.total=t.length},upload:function(){0!==this.assetNumbers.total?(this.loading=!0,this.$refs.assetUpload.submit()):this.$message.error("请先选择素材")},uploadErr:function(e,t,a){this.assetNumbers.failed++,this.$notify.error({title:"上传错误提示",message:"".concat(t.name," 上传失败：").concat(e),duration:1e4}),this.checkUploadComplete()},uploadSuccess:function(e,t,a){this.assetNumbers.success++,this.checkUploadComplete()},checkUploadComplete:function(){this.assetNumbers.failed+this.assetNumbers.success>=this.assetNumbers.total&&(this.loading=!1,this.assetNumbers.success,this.assetNumbers.failed)},cancel:function(){this.visible=!1,this.$emit("upload-success")},overLimit:function(){this.$message.error("最多一次选择 5 个素材")}}},d=u,f=a("e607"),p=Object(f["a"])(d,i,o,!1,null,null,null),h=p.exports,m=a("fc23"),g={components:{ImageUpload:h,Page:m["a"]},data:function(){return{loading:!1,search:{name:"",page:1,page_size:10},assets:{total:0,list:[]}}},filters:{lsImg:function(e){return c["b"]+e}},mounted:function(){this.fetchData()},methods:{fetchData:function(){var e=this;this.loading=!0,Object(c["c"])(this.search).then((function(t){e.loading=!1,e.assets=t.data})).catch((function(t){e.loading=!1}))},delRow:function(e){var t=this;this.$confirm("已设置的课程图不会丢失，新课程无法选此图片，确定删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then((function(){t.loading=!0,Object(c["a"])(e).then((function(e){t.loading=!1,t.$message.success("删除成功"),t.fetchData()})).catch((function(e){t.loading=!1}))})).catch((function(){}))},uploadResource:function(){this.$refs.upload.initUpload()},handlePage:function(e){this.search.page=e,this.fetchData()},handlePageSize:function(e){this.search.page_size=e,this.fetchData()}}},b=g,v=(a("ba6f"),Object(f["a"])(b,n,s,!1,null,"580dbff0",null));t["default"]=v.exports},fc23:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-pagination",{attrs:{background:"","current-page":e.page,"page-size":e.limit,total:e.total,"hide-on-single-page":"",layout:"prev, pager, next, jumper, total, sizes","prev-text":"上页","next-text":"下页","page-sizes":[10,15,20,30,40,50,100]},on:{"current-change":e.handlePage,"size-change":e.handleSizeChange}})},s=[],i=(a("431d"),{props:{page:{type:Number,default:1},total:{type:Number,default:0},limit:{type:Number,default:10}},methods:{handlePage:function(e){this.$emit("current-change",e)},handleSizeChange:function(e){this.$emit("size-change",e)}}}),o=i,l=a("e607"),r=Object(l["a"])(o,n,s,!1,null,null,null);t["a"]=r.exports}}]);